/**
 * 移动端视口高度解决方案
 * 解决手机浏览器地址栏动态变化导致的页面高度问题
 */

/* 基础视口设置 */
:root {
    /* 使用CSS自定义属性来动态设置视口高度 */
    --vh: 1vh;
    --vw: 1vw;
}

/* 移动端视口高度修复 */
@media screen and (max-width: 768px) {
    /* 重置所有可能影响高度的元素 */
    html, body {
        height: 100% !important;
        height: 100vh !important;
        height: calc(var(--vh, 1vh) * 100) !important;
        overflow: hidden !important;
        margin: 0 !important;
        padding: 0 !important;
    }
    
    /* 主布局容器 */
    #ai-chat-x-main-layout {
        height: 100vh !important;
        height: calc(var(--vh, 1vh) * 100) !important;
        min-height: 100vh !important;
        min-height: calc(var(--vh, 1vh) * 100) !important;
        max-height: 100vh !important;
        max-height: calc(var(--vh, 1vh) * 100) !important;
        overflow: hidden !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        width: calc(var(--vw, 1vw) * 100) !important;
    }
    
    /* 确保内容区域正确计算高度 */
    #ai-chat-x-right-content {
        height: calc(100vh - 50px) !important;
        height: calc(calc(var(--vh, 1vh) * 100) - 50px) !important;
        min-height: calc(100vh - 50px) !important;
        min-height: calc(calc(var(--vh, 1vh) * 100) - 50px) !important;
        max-height: calc(100vh - 50px) !important;
        max-height: calc(calc(var(--vh, 1vh) * 100) - 50px) !important;
        overflow: hidden !important;
    }
    
    /* 聊天历史区域 */
    #ai-chat-x-history {
        height: calc(100vh - 120px) !important;
        height: calc(calc(var(--vh, 1vh) * 100) - 120px) !important;
        min-height: calc(100vh - 120px) !important;
        min-height: calc(calc(var(--vh, 1vh) * 100) - 120px) !important;
        max-height: calc(100vh - 120px) !important;
        max-height: calc(calc(var(--vh, 1vh) * 100) - 120px) !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
    }
    
    /* 输入区域 */
    #ai-chat-x-input-container {
        height: 70px !important;
        min-height: 70px !important;
        max-height: 70px !important;
        flex-shrink: 0 !important;
    }
    
    /* 页首区域 */
    #ai-chat-x-header {
        height: 50px !important;
        min-height: 50px !important;
        max-height: 50px !important;
        flex-shrink: 0 !important;
    }
}

/* 超小屏幕优化 */
@media screen and (max-width: 480px) {
    #ai-chat-x-main-layout {
        height: 100vh !important;
        height: calc(var(--vh, 1vh) * 100) !important;
    }
    
    #ai-chat-x-right-content {
        height: calc(100vh - 45px) !important;
        height: calc(calc(var(--vh, 1vh) * 100) - 45px) !important;
    }
    
    #ai-chat-x-history {
        height: calc(100vh - 110px) !important;
        height: calc(calc(var(--vh, 1vh) * 100) - 110px) !important;
    }
    
    #ai-chat-x-header {
        height: 45px !important;
        min-height: 45px !important;
    }
    
    #ai-chat-x-input-container {
        height: 65px !important;
        min-height: 65px !important;
    }
}

/* 横屏模式优化 */
@media screen and (max-width: 768px) and (orientation: landscape) {
    #ai-chat-x-main-layout {
        height: 100vh !important;
        height: calc(var(--vh, 1vh) * 100) !important;
    }
    
    #ai-chat-x-right-content {
        height: calc(100vh - 40px) !important;
        height: calc(calc(var(--vh, 1vh) * 100) - 40px) !important;
    }
    
    #ai-chat-x-history {
        height: calc(100vh - 90px) !important;
        height: calc(calc(var(--vh, 1vh) * 100) - 90px) !important;
    }
    
    #ai-chat-x-header {
        height: 40px !important;
        min-height: 40px !important;
    }
    
    #ai-chat-x-input-container {
        height: 50px !important;
        min-height: 50px !important;
    }
}

/* 防止页面滚动 */
body {
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
    overflow: hidden !important;
}

/* 确保所有容器都不会超出视口 */
* {
    box-sizing: border-box !important;
}

/* 特殊处理：防止某些元素导致页面滚动 */
.ant-layout,
.ant-layout-content,
.ant-layout-header,
.ant-layout-footer {
    max-height: 100vh !important;
    max-height: calc(var(--vh, 1vh) * 100) !important;
    overflow: hidden !important;
}

/* 聊天消息容器 */
.ai-chat-x-message-container {
    max-height: calc(100vh - 140px) !important;
    max-height: calc(calc(var(--vh, 1vh) * 100) - 140px) !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

/* 滚动条优化 */
.ai-chat-x-message-container::-webkit-scrollbar,
#ai-chat-x-history::-webkit-scrollbar {
    width: 4px !important;
}

.ai-chat-x-message-container::-webkit-scrollbar-track,
#ai-chat-x-history::-webkit-scrollbar-track {
    background: transparent !important;
}

.ai-chat-x-message-container::-webkit-scrollbar-thumb,
#ai-chat-x-history::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2) !important;
    border-radius: 2px !important;
}

.ai-chat-x-message-container::-webkit-scrollbar-thumb:hover,
#ai-chat-x-history::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3) !important;
}
