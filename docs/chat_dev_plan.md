chat 页面开发计划（功能清单/进度跟踪）

目标

- 基于当前 chat 页架构，梳理功能清单，明确已实现与未实现项；定义优先级与里程碑，作为后续开发跟踪依据。

功能清单与实现状态

- 会话管理
  - 已实现：
    - 新建会话（左侧按钮，写入 Conversations）
    - 删除会话（会话项右侧菜单）
    - 重命名会话（会话项右侧菜单 + 弹窗）
    - 刷新会话列表（触发器 -> 重新渲染）
  - 未实现：
    - 会话切换选中态与高亮（当前选中 conv 显示/状态保持）
    - 置顶/收藏/归档/批量删除
    - 未读数与已读同步
    - 会话搜索/筛选（名称、时间）

- 聊天交互（发送与渲染）
  - 已实现：
    - 话题快捷项点击填充输入框
    - 发送消息（按钮/回车）并写入用户消息
    - 插入占位 AI 消息（is_streaming=True）
    - SSE 建连（POST /stream）并流式接收
    - 客户端累加 Markdown 文本，完成后同步 Store
    - Markdown 展示（FefferyMarkdown）
  - 未实现：
    - 发送中禁用按钮/显示状态
    - 取消/重试/重新生成
    - 多段回复/函数调用结果的结构化渲染
    - 图片/文件消息展示与上传处理
    - 引用/引用回复/多选复制

- 历史消息与性能
  - 已实现：
    - 基于 `AiChatMessageHistory` 的完整渲染（用户/AI/系统消息）
  - 未实现：
    - 虚拟化列表（长对话性能优化）
    - 大文本折叠/展开
    - 消息锚点与跳转
    - 按会话分页或增量加载

- SSE 与稳定性
  - 已实现：
    - `/stream` 端点对接 YYChatClient 流式
    - 出错时推送 error JSON
  - 未实现：
    - 前端断线重连/超时提示/退避重试
    - SSE 心跳/活跃检测
    - 速率限制/日志追踪 ID

- 用户偏好与信息抽屉
  - 已实现：
    - 偏好设置抽屉骨架（主题/语言示例）
    - 我的信息抽屉（健康相关示例内容）
    - 抽屉响应式宽度 clientside 回调
  - 未实现：
    - 偏好项持久化（本地/服务端）
    - 真实用户数据渲染与编辑

- 权限与导航
  - 已实现：
    - 登录校验与角色跳转（普通用户默认跳 `/core/chat`）
    - 全局 403/404/500 状态页
  - 未实现：
    - 细粒度功能级权限（如：删除会话仅管理员）

- 其它 UX/可用性
  - 已实现：
    - 顶部进度（全局）、全局消息提示、重定向
    - 统一样式工具 `style()` 与 Feffery 容器/阴影/滚动
  - 未实现：
    - 键盘快捷键（切换会话、聚焦输入）
    - 回到底部/新消息提示
    - 复制按钮与“继续写/改写/总结”等快捷操作

优先级建议（P0-P2）

- P0（本期必须）：
  - 会话切换选中态与高亮；切换即绑定 `current_session_id` 与 SSE 请求，隔离跨会话流
  - 发送中禁用/状态提示；取消/重试基础能力
  - SSE 断线提示与基础重试
- P1（次优先）：
  - 历史消息虚拟化；大文本折叠
  - 会话搜索/筛选；未读数
  - 偏好项持久化（主题/语言）
- P2（增值）：
  - 文件/图片消息；结构化工具结果渲染
  - 高级权限粒度；置顶/收藏/归档
  - 快捷操作（改写/总结/继续写）、快捷键

里程碑划分

- M1（基础稳定）：P0 全部完成
- M2（性能与易用）：完成 P1
- M3（高级能力）：推进 P2

追踪方式

- 以本文件为主记录功能与状态；每次提交同步勾选
- 在 `docs/README.md` 添加链接，形成统一入口
