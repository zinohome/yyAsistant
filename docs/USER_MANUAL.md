# yyAsistant 用户手册

**版本**: 3.0.0  
**日期**: 2024-10-24

## 📖 用户手册概述

欢迎使用yyAsistant v3.0.0！这是一个全新的智能助手应用，采用了现代化的架构设计，为您提供更可靠、更快速、更智能的聊天体验。

## 🚀 新版本特性

### 核心功能
- **智能聊天**: 支持文本聊天、语音聊天、实时通话
- **状态管理**: 8个清晰状态，确保系统稳定运行
- **事件驱动**: 11种事件类型，支持异步处理
- **智能超时**: 动态超时计算，适应不同内容长度
- **错误恢复**: 自动错误检测和恢复
- **性能监控**: 实时性能指标和健康状态

### 技术亮点
- 模块化设计，易于维护和扩展
- 完整的测试覆盖
- 统一的配置管理
- 智能的资源管理
- 自动化的健康检查

## 🎯 功能特性

### 1. 文本聊天
- **智能对话**: 支持多轮对话，上下文理解
- **流式响应**: 实时显示AI回复，提升用户体验
- **话题提示**: 智能话题推荐，丰富对话内容
- **消息管理**: 支持消息重生成、复制、取消等操作

### 2. 语音聊天
- **语音录制**: 高质量语音录制，支持实时转录
- **语音合成**: 自然流畅的语音回复
- **音频可视化**: 实时音频波形显示
- **语音控制**: 支持语音命令和交互

### 3. 实时通话
- **实时对话**: 支持实时语音对话
- **低延迟**: 优化的网络传输，减少延迟
- **音质优化**: 高质量音频处理
- **连接稳定**: 自动重连和心跳检测

## 🎨 用户界面

### 主界面布局
```
┌─────────────────────────────────────────────────────────┐
│  yyAsistant v3.0.0                    [用户信息] [设置]  │
├─────────────────────────────────────────────────────────┤
│  [聊天记录区域]                                          │
│  ┌─────────────────────────────────────────────────────┐ │
│  │  用户消息                                           │ │
│  │  ┌─────────────────────────────────────────────────┐ │ │
│  │  │  AI回复                                        │ │ │
│  │  │  [重生成] [复制] [取消] [👍] [👎]              │ │ │
│  │  └─────────────────────────────────────────────────┘ │ │
│  └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│  [输入区域]                                              │
│  ┌─────────────────────────────────────────────────────┐ │
│  │  [文本输入框]                    [发送] [语音] [通话] │ │
│  └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

### 状态指示器
- **音频可视化区域**: 显示音频波形和状态
- **播放状态指示器**: 显示当前播放状态
- **消息操作栏**: 提供消息操作按钮

## 🔧 配置说明

### 基本配置
```python
# 应用配置
app.name = "yyAsistant"
app.version = "3.0.0"
app.debug = False

# 服务器配置
server.host = "0.0.0.0"
server.port = 8050
server.workers = 4

# 数据库配置
database.url = "sqlite:///yyAsistant.db"
database.pool_size = 10
```

### 语音配置
```python
# 语音设置
voice.enabled = True
voice.sample_rate = 16000
voice.channels = 1
voice.bit_depth = 16

# WebSocket配置
websocket.url = "ws://localhost:8000/ws"
websocket.reconnect_attempts = 5
websocket.heartbeat_interval = 30
```

### 超时配置
```python
# 超时设置
timeout.sse.base = 30
timeout.sse.per_char = 0.1
timeout.sse.max = 300

timeout.tts.base = 60
timeout.tts.per_char = 0.2
timeout.tts.max = 600

timeout.stt.base = 30
timeout.stt.per_char = 0.05
timeout.stt.max = 180
```

## 🎮 使用指南

### 开始使用

1. **启动应用**
   ```bash
   # 使用部署脚本
   ./scripts/deploy.sh
   
   # 或手动启动
   source .venv/bin/activate
   python app.py
   ```

2. **访问应用**
   - 打开浏览器访问: `http://localhost:8050`
   - 登录您的账户
   - 开始使用智能助手

### 文本聊天

1. **发送消息**
   - 在输入框中输入您的问题
   - 点击"发送"按钮或按Enter键
   - 等待AI回复

2. **消息操作**
   - **重生成**: 点击🔄按钮重新生成回复
   - **复制**: 点击📋按钮复制回复内容
   - **取消**: 点击❌按钮取消正在进行的操作
   - **反馈**: 点击👍或👎按钮提供反馈

3. **话题提示**
   - 点击话题按钮快速开始对话
   - 系统会推荐相关话题
   - 支持自定义话题

### 语音聊天

1. **开始录音**
   - 点击🎤按钮开始录音
   - 说话时系统会显示音频波形
   - 录音完成后自动发送

2. **语音回复**
   - AI回复会自动转换为语音播放
   - 可以调整音量、语速、音色
   - 支持暂停、继续、停止操作

3. **音频可视化**
   - 实时显示音频波形
   - 显示播放进度
   - 提供音频控制按钮

### 实时通话

1. **开始通话**
   - 点击📞按钮开始实时通话
   - 系统会建立WebSocket连接
   - 支持双向语音对话

2. **通话控制**
   - 静音/取消静音
   - 音量调节
   - 通话质量显示

3. **通话结束**
   - 点击📞按钮结束通话
   - 系统会自动断开连接
   - 保存通话记录

## 📊 性能监控

### 系统状态
- **健康检查**: 自动检查系统健康状态
- **性能指标**: 实时显示性能数据
- **资源使用**: 监控内存、CPU使用情况
- **连接状态**: 显示WebSocket连接状态

### 监控面板
```
┌─────────────────────────────────────────────────────────┐
│  系统监控面板                                           │
├─────────────────────────────────────────────────────────┤
│  状态: 健康 ✅                                          │
│  响应时间: 300ms                                       │
│  内存使用: 150MB                                       │
│  CPU使用: 25%                                          │
│  连接数: 5                                             │
│  错误数: 0                                             │
└─────────────────────────────────────────────────────────┘
```

## 🔍 故障排除

### 常见问题

**Q: 应用无法启动？**
A: 检查Python版本和依赖安装，运行部署脚本。

**Q: 语音功能不工作？**
A: 检查麦克风权限和WebSocket连接。

**Q: 响应速度慢？**
A: 检查网络连接和服务器性能。

**Q: 出现错误？**
A: 查看日志文件，系统会自动尝试恢复。

### 日志查看
```bash
# 查看应用日志
tail -f logs/app.log

# 查看错误日志
grep -i error logs/app.log

# 查看性能日志
grep -i performance logs/app.log
```

### 健康检查
```bash
# 运行健康检查
./health_check.sh

# 查看监控信息
./monitor.sh
```

## 🛠️ 高级功能

### 自定义配置
```python
# 修改配置文件
vim config/config.py

# 重启应用
./stop_app.sh
./start_app.sh
```

### 性能调优
```python
# 调整超时设置
timeout.sse.base = 60  # 增加SSE超时
timeout.tts.max = 900  # 增加TTS最大超时

# 调整资源限制
resource.max_connections = 200
resource.max_cache_size = 2000
```

### 监控和日志
```python
# 启用详细日志
logging.level = "DEBUG"

# 启用性能监控
performance.monitoring = True
performance.interval = 10

# 启用健康检查
health.checking = True
health.interval = 30
```

## 📚 技术文档

### 架构文档
- `docs/refactoring/01-project-analysis.md` - 项目分析
- `docs/refactoring/03-refactoring-overview.md` - 重构概述
- `docs/refactoring/08-implementation-plan.md` - 实施计划

### 开发文档
- `docs/refactoring/09-code-migration-strategy.md` - 代码迁移策略
- `docs/refactoring/11-coding-standards.md` - 编码规范
- `docs/MIGRATION_GUIDE.md` - 迁移指南

### 测试文档
- `tests/unit/` - 单元测试
- `tests/integration/` - 集成测试
- `tests/e2e/` - 端到端测试

## 🎉 总结

yyAsistant v3.0.0为您提供了全新的智能助手体验：

- **更可靠**: 统一的状态管理和错误处理
- **更快速**: 优化的性能和智能超时
- **更智能**: 事件驱动架构和自动恢复
- **更稳定**: 完整的测试覆盖和健康检查

享受新版本带来的改进吧！🚀

## 📞 支持

如果您在使用过程中遇到问题，请：

1. 查看本文档的故障排除部分
2. 检查日志文件获取详细错误信息
3. 运行健康检查脚本验证系统状态
4. 参考技术文档了解详细用法

祝您使用愉快！🎉
